import{f as ut,a as gt}from"../chunks/Hm1P2KrC.js";import{i as ft}from"../chunks/B6S-3aiA.js";import{o as mt}from"../chunks/DSgEMVr_.js";import{p as pt,a as vt,n as yt}from"../chunks/CREA1FDS.js";var xt=ut('<div id="app" class="flex h-screen w-full"><div id="sidebar" class="sticky-sidebar flex-shrink-0 bg-white shadow-lg"><div class="h-auto md:h-24 border-b border-gray-200 flex flex-col justify-center p-4 sticky-header bg-white"><h2 class="text-lg font-bold text-gray-700 text-center">Lines</h2> <div class="mt-2 space-y-2"><div class="flex space-x-2"><input type="date" id="date-picker" class="text-xs p-1 border rounded w-full"/> <button id="go-to-date-btn" class="text-xs bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded">Go</button></div> <button id="go-to-today-btn" class="text-xs bg-gray-200 hover:bg-gray-300 text-gray-800 w-full px-2 py-1 rounded">Go to Today</button></div></div> <div id="sidebar-rows" class="divide-y divide-gray-200"></div></div> <div id="main-content" class="flex-1 flex flex-col"><div id="calendar-header" class="sticky-header flex-shrink-0 bg-white shadow z-10"><div id="calendar-dates" class="flex"></div></div> <div id="calendar-body" class="flex-1 calendar-scroll"><div id="calendar-grid" class="relative min-w-max"></div></div></div></div> <div id="loading-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50"><div class="bg-white p-6 rounded-lg shadow-xl"><div class="text-lg font-semibold">Loading Planner...</div></div></div> <div id="tooltip" class="fixed z-50 hidden px-3 py-2 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm" role="tooltip"></div>',1);function Mt(J,F){pt(F,!1),mt(()=>{const z=[{id:"line-1",name:"Line 01"},{id:"line-2",name:"Line 02"},{id:"line-3",name:"Line 03"},{id:"line-4",name:"Line 04 (Sewing)"},{id:"line-5",name:"Line 05"},{id:"line-6",name:"Line 06 (Sewing)"},{id:"line-7",name:"Line 07 (Finishing)"},{id:"line-8",name:"Line 08"}],G=[{id:"task-101",lineId:"line-1",orderId:"PO-4567",style:"T-Shirt (Red)",quantity:500,start:"2025-11-01T09:00:00",end:"2025-11-01T13:30:00"},{id:"task-102",lineId:"line-1",orderId:"PO-4568",style:"Polo (Blue)",quantity:300,start:"2025-11-01T14:00:00",end:"2025-11-01T17:00:00"},{id:"task-103",lineId:"line-2",orderId:"PO-4569",style:"Jeans (Black)",quantity:1200,start:"2025-11-03T09:00:00",end:"2025-11-06T17:00:00"},{id:"task-104",lineId:"line-3",orderId:"PO-4570",style:"Jacket (Denim)",quantity:250,start:"2025-11-03T11:30:00",end:"2025-11-03T16:00:00"},{id:"task-105",lineId:"line-4",orderId:"PO-4571",style:"Shorts (Cargo)",quantity:800,start:"2025-11-05T10:00:00",end:"2025-11-05T18:00:00"}],K=["2025-12-16","2025-12-25","2026-01-01"];let P=60;const v=200,w=100,h=8;function U(t){switch(t){case 0:return 0;case 5:return 8;case 6:return 0;default:return 10}}let x=[...G],I=[...z],Q=[...K],k=new Date;k.setHours(0,0,0,0);let g=[];const A=document.getElementById("sidebar-rows"),W=document.getElementById("calendar-dates"),S=document.getElementById("calendar-grid"),L=document.getElementById("tooltip"),H=document.getElementById("loading-modal");function E(){console.log("Rendering board..."),A.innerHTML="",W.innerHTML="",S.innerHTML="",g=[];const t=new Date(k);for(let e=0;e<P;e++){const i=new Date(t),a=i.getDay(),o=U(a),r=o===0,d=Q.includes(f(i,"YYYY-MM-DD")),u=r||d;g.push({date:i,dayOfWeek:a,workHours:o,isBlocked:u,isToday:e===0}),t.setDate(t.getDate()+1)}I.forEach(e=>{const i=document.createElement("div");i.className="flex items-center p-4 border-b border-gray-200",i.style.height=`${w}px`,i.textContent=e.name,A.appendChild(i)});let n="";g.forEach((e,i)=>{const a=document.createElement("div");a.className=`flex-shrink-0 text-center border-l border-b border-gray-200 p-2 ${e.isBlocked?"bg-gray-200 text-gray-500":"bg-white"} ${e.isToday?"bg-blue-100":""}`,a.style.width=`${v}px`,a.innerHTML=`
                        <div class="font-semibold text-sm ${e.isToday?"text-blue-700":"text-gray-800"}">
                            ${f(e.date,"ddd")}
                        </div>
                        <div class="text-xl font-bold ${e.isToday?"text-blue-900":"text-gray-900"}">
                            ${e.date.getDate()}
                        </div>
                        <div class="text-xs text-gray-500">
                            ${f(e.date,"MMM YYYY")}
                        </div>
                        <div class="text-xs font-medium mt-1 ${e.isBlocked?"text-red-600":"text-green-600"}">
                            ${e.isBlocked?e.isHoliday?"Holiday":"Weekend":`${e.workHours} Hours`}
                        </div>
                    `,W.appendChild(a);let o="none",r="none";if(e.workHours>0){const d=100/e.workHours;o=`repeating-linear-gradient(to right, #f0f0f0 0, #f0f0f0 1px, transparent 1px, transparent ${d}%)`,r=`repeating-linear-gradient(to right, #a5b4fc 0, #a5b4fc 1px, transparent 1px, transparent ${d}%)`}I.forEach((d,u)=>{const l=`cell-${d.id}-${f(e.date,"YYYY-MM-DD")}`;n+=`
                            <div id="${l}"
                                 class="grid-cell absolute border-r border-b border-gray-200 ${e.isBlocked?"bg-gray-100":"bg-white"}"
                                 style="left: ${i*v}px; top: ${u*w}px; width: ${v}px; height: ${w}px; --grid-lines-faint: ${o}; --grid-lines-strong: ${r};"
                                 data-line-id="${d.id}"
                                 data-date="${f(e.date,"YYYY-MM-DD")}"
                                 data-is-blocked="${e.isBlocked}">
                            </div>
                        `})}),S.innerHTML=n;const s=document.createElement("div");s.className="flex-shrink-0 text-center border-l border-b border-gray-200 p-2 bg-gray-50 hover:bg-gray-100 cursor-pointer flex flex-col justify-center items-center",s.style.width="120px",s.innerHTML=`
                    <div class="font-semibold text-sm text-blue-600">Load More</div>
                    <div class="text-xs text-gray-500 mt-2">(${P} days shown)</div>
                `,s.addEventListener("click",()=>{P+=30,H.style.display="flex",setTimeout(()=>E(),50)}),W.appendChild(s),x.forEach(e=>{const i=new Date(e.start),a=new Date(e.end),o=I.findIndex(m=>m.id===e.lineId);if(o===-1){console.warn("Task line not found:",e.id);return}const r=B(i);if(r===null){console.warn("Could not calculate start pixel for task:",e.id);return}let d=B(a);d===null&&(console.warn("Could not calculate end pixel for task:",e.id),d=(g.length-1)*v+v);const u=d-r;if(u<=0){console.warn("Task has zero or negative width:",e.id);return}const l=document.createElement("div");l.dataset.taskId=e.id,l.id=`${e.id}-task`,l.className="task absolute bg-blue-600 border border-blue-800 rounded-lg p-2 text-white shadow-md overflow-hidden cursor-grab active:cursor-grabbing",l.style.left=`${r}px`,l.style.top=`${o*w+10}px`,l.style.width=`${u}px`,l.style.height=`${w-20}px`,l.setAttribute("draggable","true"),l.innerHTML=`
                        <div class="font-bold text-sm truncate">${e.orderId}</div>
                        <div class="text-xs truncate">${e.style}</div>
                        <div class="text-xs truncate">Qty: ${e.quantity}</div>
                    `,l.dataset.tooltipContent=`
                        <strong>Order:</strong> ${e.orderId}<br>
                        <strong>Style:</strong> ${e.style}<br>
                        <strong>Qty:</strong> ${e.quantity}<br>
                        <strong>Start:</strong> ${f(i,"YYYY-MM-DD HH:mm")}<br>
                        <strong>End:</strong> ${f(a,"YYYY-MM-DD HH:mm")}
                    `,S.appendChild(l)}),V(),st(),rt(),H.style.display="none",console.log("Render complete.")}let T=null,O=0,c=null;function V(){document.querySelectorAll(".task").forEach(s=>{s.addEventListener("dragstart",Z),s.addEventListener("dragend",at)}),document.querySelectorAll("#calendar-grid div[data-line-id]").forEach(s=>{s.addEventListener("dragover",tt),s.addEventListener("dragleave",et),s.addEventListener("drop",nt)})}function Z(t){const n=t.target.dataset.taskId;if(!n){console.error("Dragged element is not a task."),t.preventDefault();return}T=n;const s=x.find(u=>u.id===T);s.lineId;const e=t.target.getBoundingClientRect(),i=t.clientX-e.left,a=new Date(s.start),o=new Date(s.end);O=0;let r=new Date(a);for(r.setHours(0,0,0,0);r<o;){const u=f(r,"YYYY-MM-DD"),l=g.find(m=>f(m.date,"YYYY-MM-DD")===u);if(l&&!l.isBlocked&&l.workHours>0){const m=new Date(l.date);m.setHours(h,0,0,0);const M=new Date(m.getTime()+l.workHours*60*6e4),b=new Date(Math.max(a.getTime(),m.getTime())),Y=new Date(Math.min(o.getTime(),M.getTime()));Y>b&&(O+=(Y.getTime()-b.getTime())/(1e3*60))}r.setDate(r.getDate()+1)}console.log("Calculated work duration (minutes):",O),t.dataTransfer.effectAllowed="move",t.dataTransfer.setData("text/plain",JSON.stringify({id:T,durationMinutes:O,taskOffsetLeft:i})),setTimeout(()=>{t.target.classList.add("dragging")},0),c&&c.remove(),c=document.createElement("div"),c.id="ghost-task";const d=t.target;c.style.top=d.style.top,c.style.left=d.style.left,c.style.width=d.style.width,c.style.height=d.style.height,c.classList.add("valid"),S.appendChild(c)}function tt(t){t.preventDefault();const n=t.target.closest(".grid-cell");if(!n||!c)return;const s=n.dataset.lineId,e=n.dataset.date,i=n.dataset.isBlocked==="true",a=t.dataTransfer.getData("text/plain");if(!a)return;const{id:o,durationMinutes:r,taskOffsetLeft:d}=JSON.parse(a),u=g.find(R=>f(R.date,"YYYY-MM-DD")===e);if(i||!u||u.workHours===0){c.classList.remove("valid"),c.classList.add("invalid"),t.dataTransfer.dropEffect="none",n.classList.add("drag-over");return}const l=u.workHours*60,m=n.getBoundingClientRect(),b=t.clientX-d-m.left,Y=Math.max(0,Math.min(1,b/v));let y=Math.floor(Y*l);const D=new Date(`${e}T00:00:00`);D.setHours(h),D.setMinutes(D.getMinutes()+y);const $=q(D,r),N=_(o,s,D,$),p=B(D),C=B($);if(p===null||C===null){c.classList.remove("valid"),c.classList.add("invalid"),t.dataTransfer.dropEffect="none";return}const lt=C-p,ct=I.findIndex(R=>R.id===s)*w+10;c.style.left=`${p}px`,c.style.width=`${lt}px`,c.style.top=`${ct}px`,N?(c.classList.remove("valid"),c.classList.add("invalid"),t.dataTransfer.dropEffect="none"):(c.classList.remove("invalid"),c.classList.add("valid"),t.dataTransfer.dropEffect="move"),n.classList.add("drag-over")}function et(t){const n=t.target.closest(".grid-cell");n&&n.classList.remove("drag-over")}function nt(t){t.preventDefault();const n=t.target.closest(".grid-cell");if(!n)return;n.classList.remove("drag-over"),n.classList.remove("drag-over-invalid");const s=n.dataset.lineId,e=n.dataset.date,i=n.dataset.isBlocked==="true",{id:a,durationMinutes:o,taskOffsetLeft:r}=JSON.parse(t.dataTransfer.getData("text/plain"));if(i){console.warn("Cannot drop on a blocked day!");return}const d=g.find(p=>f(p.date,"YYYY-MM-DD")===e);if(!d||d.workHours===0){console.warn("Cannot drop on non-working day.");return}const u=d.workHours*60,l=n.getBoundingClientRect(),M=t.clientX-r-l.left,b=Math.max(0,Math.min(1,M/v));let Y=Math.floor(b*u);const y=new Date(`${e}T00:00:00`);y.setHours(h),y.setMinutes(y.getMinutes()+Y);let D=o,$=new Date(y),N=g.findIndex(p=>f(p.date,"YYYY-MM-DD")===e);if($=q(y,o),D>0&&N>=g.length&&console.warn("Could not place full task duration within visible calendar."),_(a,s,y,$)){console.warn("DROP REJECTED: Task would overlap with another task.");return}if(s&&a){const p=x.findIndex(C=>C.id===a);p!==-1&&(x[p].lineId=s,x[p].start=y.toISOString(),x[p].end=$.toISOString(),console.log(`Task ${a} moved to ${s} at ${y.toISOString()}`),E())}}function at(t){if(c&&(c.remove(),c=null),T){const n=document.getElementById(`${T}-task`);n&&n.classList.remove("dragging")}T=null}function _(t,n,s,e){const i=x.filter(a=>a.lineId===n&&a.id!==t);for(const a of i){const o=new Date(a.start),r=new Date(a.end);if(s<r&&e>o)return!0}return!1}function q(t,n){let s=n,e=new Date(t),i=f(t,"YYYY-MM-DD"),a=g.findIndex(o=>f(o.date,"YYYY-MM-DD")===i);if(a===-1)return console.error("Could not find start day in calendar"),t;for(;s>0&&a<g.length;){const o=g[a];if(!o.isBlocked&&o.workHours>0){const r=new Date(o.date);r.setHours(h,0,0,0);const d=new Date(r.getTime()+o.workHours*60*6e4),u=new Date(Math.max(e.getTime(),r.getTime()));let l=(d.getTime()-u.getTime())/(1e3*60);if(l<=0){a++,a<g.length&&(e=new Date(g[a].date),e.setHours(h,0,0,0));continue}s<=l?(e=new Date(u.getTime()+s*6e4),s=0):(s-=l,e=new Date(d),a++)}else a++,a<g.length&&(e=new Date(g[a].date),e.setHours(h,0,0,0))}return e}function st(){document.querySelectorAll(".task").forEach(t=>{t.addEventListener("mouseenter",ot),t.addEventListener("mouseleave",it),t.addEventListener("mousemove",X)})}function ot(t){const n=t.currentTarget.dataset.tooltipContent;n&&(L.innerHTML=n,L.style.display="block",X(t))}function it(t){L.style.display="none"}function X(t){L.style.left=`${t.pageX+10}px`,L.style.top=`${t.pageY+10}px`}function B(t){const n=new Date(t),s=f(n,"YYYY-MM-DD"),e=g.findIndex(M=>f(M.date,"YYYY-MM-DD")===s);if(e===-1)return null;const i=g[e];if(i.isBlocked||i.workHours===0)return e*v;const a=i.workHours*60,o=new Date(i.date);o.setHours(h,0,0,0);const r=new Date(o.getTime()+i.workHours*60*6e4),m=(new Date(Math.max(o.getTime(),Math.min(r.getTime(),n.getTime()))).getTime()-o.getTime())/(1e3*60)/a*v;return e*v+m}function f(t,n){const s=t.getFullYear(),e=(t.getMonth()+1).toString().padStart(2,"0"),i=t.getDate().toString().padStart(2,"0"),a=t.getHours().toString().padStart(2,"0"),o=t.getMinutes().toString().padStart(2,"0"),r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],d=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return n==="YYYY-MM-DD"?`${s}-${e}-${i}`:n==="ddd"?r[t.getDay()]:n==="MMM YYYY"?`${d[t.getMonth()]} ${s}`:n==="HH:mm"?`${a}:${o}`:n==="YYYY-MM-DD HH:mm"?`${s}-${e}-${i} ${a}:${o}`:t.toLocaleString()}function rt(){document.getElementById("go-to-date-btn").addEventListener("click",()=>{const t=document.getElementById("date-picker");t.value&&(k=new Date(t.value+"T00:00:00"),k.setHours(0,0,0,0),H.style.display="flex",setTimeout(()=>E(),50))}),document.getElementById("go-to-today-btn").addEventListener("click",()=>{const t=new Date;t.setHours(0,0,0,0),k=t;const n=document.getElementById("date-picker");n&&(n.value=""),H.style.display="flex",setTimeout(()=>E(),50)})}function dt(){const t=f(k,"YYYY-MM-DD"),n=x.find(e=>e.id==="task-101");n&&(n.start=`${t}T09:00:00`,n.end=`${t}T13:30:00`);const s=x.find(e=>e.id==="task-102");s&&(s.start=`${t}T14:00:00`,s.end=`${t}T17:00:00`)}setTimeout(()=>{dt(),E()},500)}),ft();var j=xt();yt(4),gt(J,j),vt()}export{Mt as component};
