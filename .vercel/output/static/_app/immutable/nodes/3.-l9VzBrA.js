import{b as Re,d as rt,f as V,a as C,t as Ne,c as ge,w as st}from"../chunks/Hm1P2KrC.js";import{i as j}from"../chunks/B6S-3aiA.js";import{e as Ve,i as it,aN as Fe,o as he,h as G,j as ce,S as He,F as i,a5 as Ie,U as ot,V as lt,W as We,l as ke,g as se,C as Xe,aG as dt,f as Oe,s as ut,aO as be,aP as xe,c as de,as as Ce,Z as L,aj as Ue,aE as qe,aQ as ft,r as Je,b as ct,aR as vt,aS as $e,q as gt,d as ze,aT as Dt,k as Ke,aU as _t,aD as ht,aV as mt,a3 as Qe,O as Q,aW as pt,aH as Tt,aB as bt,aX as xt,aL as wt,x as k,ak as St,aY as kt,p as ee,aZ as P,a_ as we,a as te,P as A,_ as O,R as U,Q as E,G as y,M as le,a$ as $t}from"../chunks/CREA1FDS.js";import{r as Yt,s as ie,h as Mt}from"../chunks/tKHTZSJO.js";import{o as Ze}from"../chunks/DSgEMVr_.js";import{s as ue,a as X,i as De,p as me}from"../chunks/BWP4tkFd.js";import{d as yt,w as je}from"../chunks/D_bw_O7V.js";import{e as ne,s as K}from"../chunks/PWvj0eXD.js";function pe(e,o){return o}function Ht(e,o,t){for(var r=e.items,s=[],n=o.length,a=0;a<n;a++)_t(o[a].e,s,!0);var l=n>0&&s.length===0&&t!==null;if(l){var u=t.parentNode;ht(u),u.append(t),r.clear(),z(e,o[0].prev,o[n-1].next)}mt(s,()=>{for(var f=0;f<n;f++){var v=o[f];l||(r.delete(v.k),z(e,v.prev,v.next)),ze(v.e,!l)}})}function ve(e,o,t,r,s,n=null){var a=e,l={flags:o,items:new Map,first:null},u=(o&Fe)!==0;if(u){var f=e;a=G?he(ce(f)):f.appendChild(Ve())}G&&He();var v=null,m=!1,D=new Map,T=Ie(()=>{var d=t();return ft(d)?d:d==null?[]:qe(d)}),c,x;function p(){It(x,c,l,D,a,s,o,r,t),n!==null&&(c.length===0?v?Je(v):v=Oe(()=>n(a)):v!==null&&ct(v,()=>{v=null}))}it(()=>{x??=Qe,c=i(T);var d=c.length;if(m&&d===0)return;m=d===0;let h=!1;if(G){var w=ot(a)===lt;w!==(d===0)&&(a=We(),he(a),ke(!1),h=!0)}if(G){for(var M=null,Y,_=0;_<d;_++){if(se.nodeType===Xe&&se.data===dt){a=se,h=!0,ke(!1);break}var g=c[_],b=r(g,_);Y=Ee(se,l,M,null,g,b,_,s,o,t),l.items.set(b,Y),M=Y}d>0&&he(We())}if(G)d===0&&n&&(v=Oe(()=>n(a)));else if(ut()){var R=new Set,H=de;for(_=0;_<d;_+=1){g=c[_],b=r(g,_);var S=l.items.get(b)??D.get(b);S?(o&(be|xe))!==0&&et(S,g,_,o):(Y=Ee(null,l,null,null,g,b,_,s,o,t,!0),D.set(b,Y)),R.add(b)}for(const[I,q]of l.items)R.has(I)||H.skipped_effects.add(q.e);H.oncommit(p)}else p();h&&ke(!0),i(T)}),G&&(a=se)}function It(e,o,t,r,s,n,a,l,u){var f=(a&Dt)!==0,v=(a&(be|xe))!==0,m=o.length,D=t.items,T=t.first,c=T,x,p=null,d,h=[],w=[],M,Y,_,g;if(f)for(g=0;g<m;g+=1)M=o[g],Y=l(M,g),_=D.get(Y),_!==void 0&&(_.a?.measure(),(d??=new Set).add(_));for(g=0;g<m;g+=1){if(M=o[g],Y=l(M,g),_=D.get(Y),_===void 0){var b=r.get(Y);if(b!==void 0){r.delete(Y),D.set(Y,b);var R=p?p.next:c;z(t,p,b),z(t,b,R),Ye(b,R,s),p=b}else{var H=c?c.e.nodes_start:s;p=Ee(H,t,p,p===null?t.first:p.next,M,Y,g,n,a,u)}D.set(Y,p),h=[],w=[],c=p.next;continue}if(v&&et(_,M,g,a),(_.e.f&$e)!==0&&(Je(_.e),f&&(_.a?.unfix(),(d??=new Set).delete(_))),_!==c){if(x!==void 0&&x.has(_)){if(h.length<w.length){var S=w[0],I;p=S.prev;var q=h[0],J=h[h.length-1];for(I=0;I<h.length;I+=1)Ye(h[I],S,s);for(I=0;I<w.length;I+=1)x.delete(w[I]);z(t,q.prev,J.next),z(t,p,q),z(t,J,S),c=S,p=J,g-=1,h=[],w=[]}else x.delete(_),Ye(_,c,s),z(t,_.prev,_.next),z(t,_,p===null?t.first:p.next),z(t,p,_),p=_;continue}for(h=[],w=[];c!==null&&c.k!==Y;)(c.e.f&$e)===0&&(x??=new Set).add(c),w.push(c),c=c.next;if(c===null)continue;_=c}h.push(_),p=_,c=_.next}if(c!==null||x!==void 0){for(var F=x===void 0?[]:qe(x);c!==null;)(c.e.f&$e)===0&&F.push(c),c=c.next;var N=F.length;if(N>0){var Z=(a&Fe)!==0&&m===0?s:null;if(f){for(g=0;g<N;g+=1)F[g].a?.measure();for(g=0;g<N;g+=1)F[g].a?.fix()}Ht(t,F,Z)}}f&&gt(()=>{if(d!==void 0)for(_ of d)_.a?.apply()}),e.first=t.first&&t.first.e,e.last=p&&p.e;for(var _e of r.values())ze(_e.e);r.clear()}function et(e,o,t,r){(r&be)!==0&&Ce(e.v,o),(r&xe)!==0?Ce(e.i,t):e.i=t}function Ee(e,o,t,r,s,n,a,l,u,f,v){var m=(u&be)!==0,D=(u&vt)===0,T=m?D?L(s,!1,!1):Ue(s):s,c=(u&xe)===0?a:Ue(a),x={i:c,v:T,k:n,a:null,e:null,prev:t,next:r};try{if(e===null){var p=document.createDocumentFragment();p.append(e=Ve())}return x.e=Oe(()=>l(e,T,c,f),G),x.e.prev=t&&t.e,x.e.next=r&&r.e,t===null?v||(o.first=x):(t.next=x,t.e.next=x.e),r!==null&&(r.prev=x,r.e.prev=x.e),x}finally{}}function Ye(e,o,t){for(var r=e.next?e.next.e.nodes_start:t,s=o?o.e.nodes_start:t,n=e.e.nodes_start;n!==null&&n!==r;){var a=Ke(n);s.before(n),n=a}}function z(e,o,t){o===null?e.first=t:(o.next=t,o.e.next=t&&t.e),t!==null&&(t.prev=o,t.e.prev=o&&o.e)}function Ot(e,o,t=!1,r=!1,s=!1){var n=e,a="";Q(()=>{var l=Qe;if(a===(a=o()??"")){G&&He();return}if(l.nodes_start!==null&&(pt(l.nodes_start,l.nodes_end),l.nodes_start=l.nodes_end=null),a!==""){if(G){se.data;for(var u=He(),f=u;u!==null&&(u.nodeType!==Xe||u.data!=="");)f=u,u=Ke(u);if(u===null)throw Tt(),bt;Re(se,f),n=he(u);return}var v=a+"";t?v=`<svg>${v}</svg>`:r&&(v=`<math>${v}</math>`);var m=rt(v);if((t||r)&&(m=ce(m)),Re(ce(m),m.lastChild),t||r)for(;ce(m);)n.before(ce(m));else n.before(m)}})}const Pe=[...` 	
\r\fÂ \v\uFEFF`];function Et(e,o,t){var r=e==null?"":""+e;if(o&&(r=r?r+" "+o:o),t){for(var s in t)if(t[s])r=r?r+" "+s:s;else if(r.length)for(var n=s.length,a=0;(a=r.indexOf(s,a))>=0;){var l=a+n;(a===0||Pe.includes(r[a-1]))&&(l===r.length||Pe.includes(r[l]))?r=(a===0?"":r.substring(0,a))+r.substring(l+1):a=l}}return r===""?null:r}function Lt(e,o){return e==null?null:String(e)}function oe(e,o,t,r,s,n){var a=e.__className;if(G||a!==t||a===void 0){var l=Et(t,r,n);(!G||l!==e.getAttribute("class"))&&(l==null?e.removeAttribute("class"):e.className=l),e.__className=t}else if(n&&s!==n)for(var u in n){var f=!!n[u];(s==null||f!==!!s[u])&&e.classList.toggle(u,f)}return n}function fe(e,o,t,r){var s=e.__style;if(G||s!==o){var n=Lt(o);(!G||n!==e.getAttribute("style"))&&(n==null?e.removeAttribute("style"):e.style.cssText=n),e.__style=o}return r}function At(e,o,t=o){var r=new WeakSet;xt(e,"input",async s=>{var n=s?e.defaultValue:e.value;if(n=Me(e)?ye(n):n,t(n),de!==null&&r.add(de),await wt(),n!==(n=o())){var a=e.selectionStart,l=e.selectionEnd,u=e.value.length;if(e.value=n??"",l!==null){var f=e.value.length;a===l&&l===u&&f>u?(e.selectionStart=f,e.selectionEnd=f):(e.selectionStart=a,e.selectionEnd=Math.min(l,f))}}}),(G&&e.defaultValue!==e.value||k(o)==null&&e.value)&&(t(Me(e)?ye(e.value):e.value),de!==null&&r.add(de)),St(()=>{var s=o();if(e===document.activeElement){var n=kt??de;if(r.has(n))return}Me(e)&&s===ye(e.value)||e.type==="date"&&!s&&!e.value||s!==e.value&&(e.value=s??"")})}function Me(e){var o=e.type;return o==="number"||o==="range"}function ye(e){return e===""?null:+e}const $={NUM_DAYS_DEFAULT:60,DAY_COLUMN_WIDTH:200,ROW_HEIGHT:100,START_HOUR:8,END_HOUR:18},re={SUNDAY:0,MONDAY:10,TUESDAY:10,WEDNESDAY:10,THURSDAY:10,FRIDAY:8,SATURDAY:0};function Rt(e){return[re.SUNDAY,re.MONDAY,re.TUESDAY,re.WEDNESDAY,re.THURSDAY,re.FRIDAY,re.SATURDAY][e]||0}function W(e,o){const t=e.getFullYear(),r=(e.getMonth()+1).toString().padStart(2,"0"),s=e.getDate().toString().padStart(2,"0"),n=e.getHours().toString().padStart(2,"0"),a=e.getMinutes().toString().padStart(2,"0"),l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],u=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];return o==="YYYY-MM-DD"?`${t}-${r}-${s}`:o==="ddd"?l[e.getDay()]:o==="MMM YYYY"?`${u[e.getMonth()]} ${t}`:o==="HH:mm"?`${n}:${a}`:o==="YYYY-MM-DD HH:mm"?`${t}-${r}-${s} ${n}:${a}`:e.toLocaleString()}function Nt(e,o,t){const r=[],s=new Date(e);for(let n=0;n<o;n++){const a=new Date(s),l=a.getDay(),u=Rt(l),f=u===0,v=t.includes(W(a,"YYYY-MM-DD")),m=f||v;r.push({date:a,dayOfWeek:l,workHours:u,isBlocked:m,isToday:n===0}),s.setDate(s.getDate()+1)}return r}function Wt(){const{subscribe:e,set:o,update:t}=je({lines:[],tasks:[],holidays:[],today:new Date,numDaysToShow:$.NUM_DAYS_DEFAULT,isLoading:!0});return{subscribe:e,setData:(r,s,n)=>{t(a=>({...a,lines:r,tasks:s,holidays:n,isLoading:!1}))},updateTask:(r,s)=>{t(n=>({...n,tasks:n.tasks.map(a=>a.id===r?{...a,...s}:a)}))},setToday:r=>{t(s=>({...s,today:r}))},loadMoreDays:()=>{t(r=>({...r,numDaysToShow:r.numDaysToShow+30}))},setLoading:r=>{t(s=>({...s,isLoading:r}))}}}const B=Wt(),Le=yt(B,e=>Nt(e.today,e.numDaysToShow,e.holidays));var Ct=V('<div class="flex items-center p-4 border-b border-gray-200"> </div>'),Ut=V('<div class="sticky left-0 z-20 flex-shrink-0 bg-white shadow-lg"><div class="h-auto md:h-24 border-b border-gray-200 flex flex-col justify-center p-4 sticky top-0 bg-white"><h2 class="text-lg font-bold text-gray-700 text-center">Lines</h2> <div class="mt-2 space-y-2"><div class="flex space-x-2"><input type="date" class="text-xs p-1 border rounded w-full"/> <button class="text-xs bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded">Go</button></div> <button class="text-xs bg-gray-200 hover:bg-gray-300 text-gray-800 w-full px-2 py-1 rounded">Go to Today</button></div></div> <div class="divide-y divide-gray-200"></div></div>');function Pt(e,o){ee(o,!1);const t=()=>X(B,"$planningStore",r),[r,s]=ue(),n=L();let a=L("");function l(){if(i(a)){const d=new Date(i(a)+"T00:00:00");d.setHours(0,0,0,0),B.setToday(d),B.setLoading(!0),setTimeout(()=>B.setLoading(!1),50)}}function u(){const d=new Date;d.setHours(0,0,0,0),B.setToday(d),O(a,""),B.setLoading(!0),setTimeout(()=>B.setLoading(!1),50)}P(()=>t(),()=>{O(n,t().lines)}),we(),j();var f=Ut(),v=A(f),m=U(A(v),2),D=A(m),T=A(D);Yt(T);var c=U(T,2);E(D);var x=U(D,2);E(m),E(v);var p=U(v,2);ve(p,5,()=>i(n),pe,(d,h)=>{var w=Ct(),M=A(w,!0);E(w),Q(()=>{fe(w,`height: ${y($),k(()=>$.ROW_HEIGHT)??""}px`),K(M,(i(h),k(()=>i(h).name)))}),C(d,w)}),E(p),E(f),At(T,()=>i(a),d=>O(a,d)),ne("click",c,l),ne("click",x,u),C(e,f),te(),s()}var Bt=V('<div><div> </div> <div> </div> <div class="text-xs text-gray-500"> </div> <div><!></div></div>'),Gt=V('<div class="sticky top-0 z-10 flex-shrink-0 bg-white shadow"><div class="flex"><!> <div class="flex-shrink-0 text-center border-l border-b border-gray-200 p-2 bg-gray-50 hover:bg-gray-100 cursor-pointer flex flex-col justify-center items-center" style="width: 120px" role="button" tabindex="0"><div class="font-semibold text-sm text-blue-600">Load More</div> <div class="text-xs text-gray-500 mt-2"> </div></div></div></div>');function Vt(e,o){ee(o,!1);const t=()=>X(Le,"$calendarDays",s),r=()=>X(B,"$planningStore",s),[s,n]=ue();function a(){B.loadMoreDays(),B.setLoading(!0),setTimeout(()=>B.setLoading(!1),50)}j();var l=Gt(),u=A(l),f=A(u);ve(f,1,t,pe,(T,c)=>{var x=Bt(),p=A(x),d=A(p,!0);E(p);var h=U(p,2),w=A(h,!0);E(h);var M=U(h,2),Y=A(M,!0);E(M);var _=U(M,2),g=A(_);{var b=H=>{var S=Ne();Q(()=>K(S,i(c).isHoliday?"Holiday":"Weekend")),C(H,S)},R=H=>{var S=Ne();Q(()=>K(S,`${i(c).workHours??""} Hours`)),C(H,S)};De(g,H=>{i(c).isBlocked?H(b):H(R,!1)})}E(_),E(x),Q((H,S,I)=>{oe(x,1,`flex-shrink-0 text-center border-l border-b border-gray-200 p-2 
                       ${i(c).isBlocked?"bg-gray-200 text-gray-500":"bg-white"}
                       ${i(c).isToday?"bg-blue-100":""}`),fe(x,`width: ${$.DAY_COLUMN_WIDTH??""}px`),oe(p,1,`font-semibold text-sm ${i(c).isToday?"text-blue-700":"text-gray-800"}`),K(d,H),oe(h,1,`text-xl font-bold ${i(c).isToday?"text-blue-900":"text-gray-900"}`),K(w,S),K(Y,I),oe(_,1,`text-xs font-medium mt-1 ${i(c).isBlocked?"text-red-600":"text-green-600"}`)},[()=>W(i(c).date,"ddd"),()=>i(c).date.getDate(),()=>W(i(c).date,"MMM YYYY")]),C(T,x)});var v=U(f,2),m=U(A(v),2),D=A(m);E(m),E(v),E(u),E(l),Q(()=>K(D,`(${r().numDaysToShow??""} days shown)`)),ne("click",v,a),ne("keydown",v,T=>T.key==="Enter"&&a()),C(e,l),te(),n()}function Ft(){const{subscribe:e,set:o,update:t}=je({draggedTaskId:null,originalLineId:null,draggedTaskDuration:0,taskOffsetLeft:0,isDragging:!1,ghostPosition:null,ghostIsValid:!0});return{subscribe:e,startDrag:(r,s,n,a)=>{o({draggedTaskId:r,originalLineId:s,draggedTaskDuration:n,taskOffsetLeft:a,isDragging:!0,ghostPosition:null,ghostIsValid:!0})},updateGhost:(r,s)=>{t(n=>({...n,ghostPosition:r,ghostIsValid:s}))},endDrag:()=>{o({draggedTaskId:null,originalLineId:null,draggedTaskDuration:0,taskOffsetLeft:0,isDragging:!1,ghostPosition:null,ghostIsValid:!0})}}}const ae=Ft();function Te(e,o){const t=new Date(e),r=W(t,"YYYY-MM-DD"),s=o.findIndex(T=>W(T.date,"YYYY-MM-DD")===r);if(s===-1)return null;const n=o[s];if(n.isBlocked||n.workHours===0)return s*$.DAY_COLUMN_WIDTH;const a=n.workHours*60,l=new Date(n.date);l.setHours($.START_HOUR,0,0,0);const u=new Date(l.getTime()+n.workHours*60*6e4),D=(new Date(Math.max(l.getTime(),Math.min(u.getTime(),t.getTime()))).getTime()-l.getTime())/(1e3*60)/a*$.DAY_COLUMN_WIDTH;return s*$.DAY_COLUMN_WIDTH+D}function Xt(e,o,t){let r=0,s=new Date(e);for(s.setHours(0,0,0,0);s<o;){const n=W(s,"YYYY-MM-DD"),a=t.find(l=>W(l.date,"YYYY-MM-DD")===n);if(a&&!a.isBlocked&&a.workHours>0){const l=new Date(a.date);l.setHours($.START_HOUR,0,0,0);const u=new Date(l.getTime()+a.workHours*60*6e4),f=new Date(Math.max(e.getTime(),l.getTime())),v=new Date(Math.min(o.getTime(),u.getTime()));v>f&&(r+=(v.getTime()-f.getTime())/(1e3*60))}s.setDate(s.getDate()+1)}return r}function Be(e,o,t){let r=o,s=new Date(e),n=W(e,"YYYY-MM-DD"),a=t.findIndex(l=>W(l.date,"YYYY-MM-DD")===n);if(a===-1)return e;for(;r>0&&a<t.length;){const l=t[a];if(!l.isBlocked&&l.workHours>0){const u=new Date(l.date);u.setHours($.START_HOUR,0,0,0);const f=new Date(u.getTime()+l.workHours*60*6e4),v=new Date(Math.max(s.getTime(),u.getTime()));let m=(f.getTime()-v.getTime())/(1e3*60);if(m<=0){a++,a<t.length&&(s=new Date(t[a].date),s.setHours($.START_HOUR,0,0,0));continue}r<=m?(s=new Date(v.getTime()+r*6e4),r=0):(r-=m,s=new Date(f),a++)}else a++,a<t.length&&(s=new Date(t[a].date),s.setHours($.START_HOUR,0,0,0))}return s}function Ge(e,o,t,r,s){const n=s.filter(a=>a.lineId===o&&a.id!==e);for(const a of n){const l=new Date(a.start),u=new Date(a.end);if(t<u&&r>l)return!0}return!1}var qt=V('<div draggable="true" role="button" tabindex="0"><div class="font-bold text-sm truncate"> </div> <div class="text-xs truncate"> </div> <div class="text-xs truncate"> </div></div>');function Jt(e,o){ee(o,!1);const t=()=>X(B,"$planningStore",n),r=()=>X(Le,"$calendarDays",n),s=()=>X(ae,"$dragStore",n),[n,a]=ue(),l=L(),u=L(),f=L(),v=L(),m=L(),D=L(),T=L(),c=L(),x=L(),p=L();let d=me(o,"task",8);function h(g){const b=g.currentTarget.getBoundingClientRect(),R=g.clientX-b.left,H=Xt(i(f),i(v),i(u));ae.startDrag(d().id,d().lineId,H,R),g.dataTransfer.effectAllowed="move",g.dataTransfer.setData("text/plain",JSON.stringify({id:d().id,durationMinutes:H,taskOffsetLeft:R})),setTimeout(()=>{g.target.classList.add("dragging")},0)}function w(g){g.target.classList.remove("dragging"),ae.endDrag()}P(()=>t(),()=>{O(l,t().lines)}),P(()=>r(),()=>{O(u,r())}),P(()=>y(d()),()=>{O(f,new Date(d().start))}),P(()=>y(d()),()=>{O(v,new Date(d().end))}),P(()=>(i(l),y(d())),()=>{O(m,i(l).findIndex(g=>g.id===d().lineId))}),P(()=>(i(f),i(u)),()=>{O(D,Te(i(f),i(u)))}),P(()=>(i(v),i(u)),()=>{O(T,Te(i(v),i(u)))}),P(()=>(i(T),i(D)),()=>{O(c,i(T)&&i(D)?i(T)-i(D):0)}),P(()=>(i(m),i(D),i(c)),()=>{O(x,i(m)!==-1&&i(D)!==null&&i(c)>0)}),P(()=>(s(),y(d())),()=>{O(p,s().draggedTaskId===d().id)}),we(),j();var M=ge(),Y=le(M);{var _=g=>{var b=qt();let R;var H=A(b),S=A(H,!0);E(H);var I=U(H,2),q=A(I,!0);E(I);var J=U(I,2),F=A(J);E(J),E(b),Q((N,Z)=>{ie(b,"id",`${y(d()),k(()=>d().id)??""}-task`),ie(b,"data-task-id",(y(d()),k(()=>d().id))),R=oe(b,1,"task absolute bg-blue-600 border border-blue-800 rounded-lg p-2 text-white shadow-md overflow-hidden cursor-grab active:cursor-grabbing svelte-1r92bhv",null,R,{dragging:i(p)}),fe(b,`left: ${i(D)??""}px; 
               top: ${i(m),y($),k(()=>i(m)*$.ROW_HEIGHT+10)??""}px; 
               width: ${i(c)??""}px; 
               height: ${y($),k(()=>$.ROW_HEIGHT-20)??""}px;`),ie(b,"data-tooltip-content",`<strong>Order:</strong> ${y(d()),k(()=>d().orderId)??""}<br><strong>Style:</strong> ${y(d()),k(()=>d().style)??""}<br><strong>Qty:</strong> ${y(d()),k(()=>d().quantity)??""}<br><strong>Start:</strong> ${N??""}<br><strong>End:</strong> ${Z??""}`),K(S,(y(d()),k(()=>d().orderId))),K(q,(y(d()),k(()=>d().style))),K(F,`Qty: ${y(d()),k(()=>d().quantity)??""}`)},[()=>(y(W),i(f),k(()=>W(i(f),"YYYY-MM-DD HH:mm"))),()=>(y(W),i(v),k(()=>W(i(v),"YYYY-MM-DD HH:mm")))]),ne("dragstart",b,h),ne("dragend",b,w),C(g,b)};De(Y,g=>{i(x)&&g(_)})}C(e,M),te(),a()}var zt=V('<div role="gridcell" tabindex="-1"></div>'),Kt=V('<div class="flex-1 overflow-x-auto"><div class="relative min-w-max"><!> <!></div></div>');function Qt(e,o){ee(o,!1);const t=()=>X(B,"$planningStore",n),r=()=>X(Le,"$calendarDays",n),s=()=>X(ae,"$dragStore",n),[n,a]=ue(),l=L(),u=L(),f=L();function v(d){if(d.workHours===0)return{faint:"none",strong:"none"};const h=100/d.workHours;return{faint:`repeating-linear-gradient(to right, #f0f0f0 0, #f0f0f0 1px, transparent 1px, transparent ${h}%)`,strong:`repeating-linear-gradient(to right, #a5b4fc 0, #a5b4fc 1px, transparent 1px, transparent ${h}%)`}}function m(d,h,w){if(d.preventDefault(),d.stopPropagation(),!s().isDragging)return;const M=w.isBlocked,Y=W(w.date,"YYYY-MM-DD");if(M||w.workHours===0){ae.updateGhost(null,!1),d.dataTransfer.dropEffect="none";return}const{draggedTaskId:_,draggedTaskDuration:g,taskOffsetLeft:b}=s(),R=w.workHours*60,S=d.currentTarget.getBoundingClientRect(),q=d.clientX-b-S.left,J=Math.max(0,Math.min(1,q/$.DAY_COLUMN_WIDTH));let F=Math.floor(J*R);const N=new Date(`${Y}T00:00:00`);N.setHours($.START_HOUR),N.setMinutes(N.getMinutes()+F);const Z=Be(N,g,i(f)),_e=Ge(_,h.id,N,Z,i(u)),Se=Te(N,i(f)),Ae=Te(Z,i(f));if(Se===null||Ae===null){ae.updateGhost(null,!1),d.dataTransfer.dropEffect="none";return}const tt=Ae-Se,at=i(l).findIndex(nt=>nt.id===h.id)*$.ROW_HEIGHT+10;ae.updateGhost({left:Se,top:at,width:tt,height:$.ROW_HEIGHT-20},!_e),d.dataTransfer.dropEffect=_e?"none":"move"}function D(d,h,w){if(d.preventDefault(),d.stopPropagation(),!s().isDragging)return;const M=w.isBlocked,Y=W(w.date,"YYYY-MM-DD");if(M||w.workHours===0){console.warn("Cannot drop on blocked day");return}const{draggedTaskId:_,draggedTaskDuration:g,taskOffsetLeft:b}=s(),R=w.workHours*60,S=d.currentTarget.getBoundingClientRect(),q=d.clientX-b-S.left,J=Math.max(0,Math.min(1,q/$.DAY_COLUMN_WIDTH));let F=Math.floor(J*R);const N=new Date(`${Y}T00:00:00`);N.setHours($.START_HOUR),N.setMinutes(N.getMinutes()+F);const Z=Be(N,g,i(f));if(Ge(_,h.id,N,Z,i(u))){console.warn("DROP REJECTED: Task would overlap");return}B.updateTask(_,{lineId:h.id,start:N.toISOString(),end:Z.toISOString()}),console.log(`Task ${_} moved to ${h.id} at ${N.toISOString()}`)}P(()=>t(),()=>{O(l,t().lines)}),P(()=>t(),()=>{O(u,t().tasks)}),P(()=>r(),()=>{O(f,r())}),we(),j();var T=Kt(),c=A(T),x=A(c);ve(x,1,()=>i(f),pe,(d,h,w)=>{var M=ge(),Y=le(M);ve(Y,1,()=>i(l),pe,(_,g,b)=>{const R=Ie(()=>(i(h),k(()=>v(i(h))))),H=Ie(()=>(i(g),y(W),i(h),k(()=>`cell-${i(g).id}-${W(i(h).date,"YYYY-MM-DD")}`)));var S=zt();Q(I=>{ie(S,"id",i(H)),oe(S,1,`absolute border-r border-b border-gray-200 grid-cell ${i(h),k(()=>i(h).isBlocked?"bg-gray-100":"bg-white")??""}`),fe(S,`left: ${y($),k(()=>w*$.DAY_COLUMN_WIDTH)??""}px; 
                           top: ${y($),k(()=>b*$.ROW_HEIGHT)??""}px; 
                           width: ${y($),k(()=>$.DAY_COLUMN_WIDTH)??""}px; 
                           height: ${y($),k(()=>$.ROW_HEIGHT)??""}px;
                           --grid-lines-faint: ${y(i(R)),k(()=>i(R).faint)??""};
                           --grid-lines-strong: ${y(i(R)),k(()=>i(R).strong)??""};
                           background-image: var(--grid-lines-faint, none);`),ie(S,"data-line-id",(i(g),k(()=>i(g).id))),ie(S,"data-date",I),ie(S,"data-is-blocked",(i(h),k(()=>i(h).isBlocked)))},[()=>(y(W),i(h),k(()=>W(i(h).date,"YYYY-MM-DD")))]),ne("dragover",S,I=>m(I,i(g),i(h))),ne("drop",S,I=>D(I,i(g),i(h))),C(_,S)}),C(d,M)});var p=U(x,2);ve(p,1,()=>i(u),d=>d.id,(d,h)=>{Jt(d,{get task(){return i(h)}})}),E(c),E(T),C(e,T),te(),a()}var Zt=V('<div id="ghost-task"></div>');function jt(e,o){ee(o,!1);const t=()=>X(ae,"$dragStore",r),[r,s]=ue(),n=L(),a=L(),l=L();P(()=>t(),()=>{O(n,t().ghostPosition)}),P(()=>t(),()=>{O(a,t().ghostIsValid)}),P(()=>(t(),i(n)),()=>{O(l,t().isDragging&&i(n))}),we(),j();var u=ge(),f=le(u);{var v=m=>{var D=Zt();Q(()=>{oe(D,1,`absolute z-50 opacity-70 border-2 border-dashed pointer-events-none rounded-lg p-2 box-border
               ${i(a)?"bg-blue-100 border-blue-500":"bg-red-100 border-red-500"}`),fe(D,`left: ${i(n),k(()=>i(n).left)??""}px; 
               top: ${i(n),k(()=>i(n).top)??""}px; 
               width: ${i(n),k(()=>i(n).width)??""}px; 
               height: ${i(n),k(()=>i(n).height)??""}px;`)}),C(m,D)};De(f,m=>{i(l)&&m(v)})}C(e,u),te(),s()}var ea=V('<div class="fixed z-50 px-3 py-2 text-sm font-medium text-white bg-gray-900 rounded-lg shadow-sm" role="tooltip"><!></div>');function ta(e,o){ee(o,!1);let t=L(!1),r=L(""),s=L(0),n=L(0);function a(D){if(!D.target||typeof D.target.closest!="function")return;const T=D.target.closest("[data-tooltip-content]");T&&(O(r,T.dataset.tooltipContent),O(t,!0),u(D))}function l(D){if(!D.target||typeof D.target.closest!="function")return;D.target.closest("[data-tooltip-content]")&&O(t,!1)}function u(D){O(s,D.pageX+10),O(n,D.pageY+10)}Ze(()=>(document.addEventListener("mouseenter",a,!0),document.addEventListener("mouseleave",l,!0),document.addEventListener("mousemove",D=>{i(t)&&u(D)}),()=>{document.removeEventListener("mouseenter",a,!0),document.removeEventListener("mouseleave",l,!0)})),j();var f=ge(),v=le(f);{var m=D=>{var T=ea(),c=A(T);Ot(c,()=>i(r)),E(T),Q(()=>fe(T,`left: ${i(s)??""}px; top: ${i(n)??""}px;`)),C(D,T)};De(v,D=>{i(t)&&D(m)})}C(e,f),te()}var aa=V('<div class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center z-50"><div class="bg-white p-6 rounded-lg shadow-xl"><div class="text-lg font-semibold">Loading Planner...</div></div></div>');function na(e,o){ee(o,!1);const t=()=>X(B,"$planningStore",r),[r,s]=ue();j();var n=ge(),a=le(n);{var l=u=>{var f=aa();C(u,f)};De(a,u=>{t().isLoading&&u(l)})}C(e,n),te(),s()}var ra=V('<div class="flex h-screen w-full bg-gray-100"><!> <div class="flex-1 flex flex-col"><!> <!></div></div> <!> <!> <!>',1);function sa(e,o){ee(o,!1);let t=me(o,"initialLines",24,()=>[]),r=me(o,"initialTasks",24,()=>[]),s=me(o,"initialHolidays",24,()=>[]);Ze(()=>{B.setData(t(),r(),s())}),j();var n=ra(),a=le(n),l=A(a);Pt(l,{});var u=U(l,2),f=A(u);Vt(f,{});var v=U(f,2);Qt(v,{}),E(u),E(a);var m=U(a,2);jt(m,{});var D=U(m,2);ta(D,{});var T=U(D,2);na(T,{}),C(e,n),te()}var ia=st(V('<script src="https://cdn.tailwindcss.com"><\/script><!>',1));function _a(e,o){ee(o,!1);const t=[{id:"line-1",name:"Line 01"},{id:"line-2",name:"Line 02"},{id:"line-3",name:"Line 03"},{id:"line-4",name:"Line 04 (Sewing)"},{id:"line-5",name:"Line 05"},{id:"line-6",name:"Line 06 (Finishing)"}],r=new Date;r.setHours(0,0,0,0);const s=W(r,"YYYY-MM-DD"),n=[{id:"task-101",lineId:"line-1",orderId:"PO-4567",style:"T-Shirt (Red)",quantity:500,start:`${s}T09:00:00`,end:`${s}T13:30:00`},{id:"task-102",lineId:"line-1",orderId:"PO-4568",style:"Polo (Blue)",quantity:300,start:`${s}T14:00:00`,end:`${s}T17:00:00`},{id:"task-103",lineId:"line-2",orderId:"PO-4569",style:"Jeans (Black)",quantity:1200,start:"2025-11-03T09:00:00",end:"2025-11-06T17:00:00"},{id:"task-104",lineId:"line-3",orderId:"PO-4570",style:"Jacket (Denim)",quantity:250,start:"2025-11-03T11:30:00",end:"2025-11-03T16:00:00"},{id:"task-105",lineId:"line-4",orderId:"PO-4571",style:"Shorts (Cargo)",quantity:800,start:"2025-11-05T10:00:00",end:"2025-11-05T18:00:00"}],a=["2025-12-16","2025-12-25","2026-01-01"];j(),Mt("1x1wh5u",l=>{var u=ia();$t.title="Garments Production Planning Board",U(le(u)),C(l,u)}),sa(e,{get initialLines(){return t},get initialTasks(){return n},get initialHolidays(){return a}}),te()}export{_a as component};
